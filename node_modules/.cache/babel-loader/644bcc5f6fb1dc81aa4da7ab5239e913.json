{"ast":null,"code":"import axios from \"axios\";\n\nclass API {\n  constructor() {\n    this.axiosInstance = null;\n\n    /* \n      üö®1 point EXTRA CREDIT üö® üëâüèø get the baseURL from the environment\n      https://create-react-app.dev/docs/adding-custom-environment-variables/\n    */\n    const axiosInstance = axios.create({\n      baseURL: \"https://kwitter-api.herokuapp.com/\",\n      timeout: 30000,\n      headers: {\n        Authorization: `Bearer ${getToken()}`\n      }\n    }); // Add a request interceptor to attach a\n\n    axiosInstance.interceptors.request.use(config => ({ ...config,\n      headers: { ...config.headers,\n        Authorization: `Bearer ${getToken()}`\n      }\n    }), error => Promise.reject(error)); // Add a response interceptor\n\n    axiosInstance.interceptors.response.use(({\n      data\n    }) => data, error => Promise.reject(error));\n    this.axiosInstance = axiosInstance;\n  }\n\n  async login({\n    username,\n    password\n  }) {\n    try {\n      const result = await this.axiosInstance.post(\"/auth/login\", {\n        username,\n        password\n      });\n      return result;\n    } catch (err) {\n      helpMeInstructor(err);\n      throw err;\n    }\n  }\n\n  async logout() {\n    try {\n      await this.axiosInstance.get(\"/auth/logout\");\n    } catch (err) {\n      helpMeInstructor(err);\n      throw err;\n    }\n  }\n\n} // WARNING.. do not touch below this line if you want to have a good day =]\n\n\nfunction helpMeInstructor(err) {\n  console.info(`\n    Did you hit CORRECT the endpoint?\n    Did you send the CORRECT data?\n    Did you make the CORRECT kind of request [GET/POST/PATCH/DELETE]?\n    Check the Kwitter docs üëâüèø https://kwitter-api.herokuapp.com/docs/#/\n    Check the Axios docs üëâüèø https://github.com/axios/axios\n    TODO: troll students\n  `, err);\n}\n\nfunction getToken() {\n  try {\n    const storedState = JSON.parse(localStorage.getItem(\"persist:root\"));\n    return JSON.parse(storedState.auth).isAuthenticated;\n  } catch {\n    return \"\";\n  }\n}\n\nexport default new API();","map":{"version":3,"sources":["/Users/dawitmac/kenzie/assessment/kwitter_jackinthebox/src/utils/api.js"],"names":["axios","API","constructor","axiosInstance","create","baseURL","timeout","headers","Authorization","getToken","interceptors","request","use","config","error","Promise","reject","response","data","login","username","password","result","post","err","helpMeInstructor","logout","get","console","info","storedState","JSON","parse","localStorage","getItem","auth","isAuthenticated"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;;AAEA,MAAMC,GAAN,CAAU;AAGRC,EAAAA,WAAW,GAAG;AAAA,SAFdC,aAEc,GAFE,IAEF;;AACZ;;;;AAIA,UAAMA,aAAa,GAAGH,KAAK,CAACI,MAAN,CAAa;AACjCC,MAAAA,OAAO,EAAE,oCADwB;AAEjCC,MAAAA,OAAO,EAAE,KAFwB;AAGjCC,MAAAA,OAAO,EAAE;AAAEC,QAAAA,aAAa,EAAG,UAASC,QAAQ,EAAG;AAAtC;AAHwB,KAAb,CAAtB,CALY,CAWZ;;AACAN,IAAAA,aAAa,CAACO,YAAd,CAA2BC,OAA3B,CAAmCC,GAAnC,CACGC,MAAD,KAAa,EACX,GAAGA,MADQ;AAEXN,MAAAA,OAAO,EAAE,EACP,GAAGM,MAAM,CAACN,OADH;AAEPC,QAAAA,aAAa,EAAG,UAASC,QAAQ,EAAG;AAF7B;AAFE,KAAb,CADF,EAQGK,KAAD,IAAWC,OAAO,CAACC,MAAR,CAAeF,KAAf,CARb,EAZY,CAuBZ;;AACAX,IAAAA,aAAa,CAACO,YAAd,CAA2BO,QAA3B,CAAoCL,GAApC,CACE,CAAC;AAAEM,MAAAA;AAAF,KAAD,KAAcA,IADhB,EAEGJ,KAAD,IAAWC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAFb;AAKA,SAAKX,aAAL,GAAqBA,aAArB;AACD;;AAED,QAAMgB,KAAN,CAAY;AAAEC,IAAAA,QAAF;AAAYC,IAAAA;AAAZ,GAAZ,EAAoC;AAClC,QAAI;AACF,YAAMC,MAAM,GAAG,MAAM,KAAKnB,aAAL,CAAmBoB,IAAnB,CAAwB,aAAxB,EAAuC;AAC1DH,QAAAA,QAD0D;AAE1DC,QAAAA;AAF0D,OAAvC,CAArB;AAIA,aAAOC,MAAP;AACD,KAND,CAME,OAAOE,GAAP,EAAY;AACZC,MAAAA,gBAAgB,CAACD,GAAD,CAAhB;AACA,YAAMA,GAAN;AACD;AACF;;AAED,QAAME,MAAN,GAAe;AACb,QAAI;AACF,YAAM,KAAKvB,aAAL,CAAmBwB,GAAnB,CAAuB,cAAvB,CAAN;AACD,KAFD,CAEE,OAAOH,GAAP,EAAY;AACZC,MAAAA,gBAAgB,CAACD,GAAD,CAAhB;AACA,YAAMA,GAAN;AACD;AACF;;AAvDO,C,CA2DV;;;AAEA,SAASC,gBAAT,CAA0BD,GAA1B,EAA+B;AAC7BI,EAAAA,OAAO,CAACC,IAAR,CACG;;;;;;;GADH,EASEL,GATF;AAWD;;AAED,SAASf,QAAT,GAAoB;AAClB,MAAI;AACF,UAAMqB,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,cAArB,CAAX,CAApB;AACA,WAAOH,IAAI,CAACC,KAAL,CAAWF,WAAW,CAACK,IAAvB,EAA6BC,eAApC;AACD,GAHD,CAGE,MAAM;AACN,WAAO,EAAP;AACD;AACF;;AAED,eAAe,IAAInC,GAAJ,EAAf","sourcesContent":["import axios from \"axios\";\n\nclass API {\n  axiosInstance = null;\n\n  constructor() {\n    /* \n      üö®1 point EXTRA CREDIT üö® üëâüèø get the baseURL from the environment\n      https://create-react-app.dev/docs/adding-custom-environment-variables/\n    */\n    const axiosInstance = axios.create({\n      baseURL: \"https://kwitter-api.herokuapp.com/\",\n      timeout: 30000,\n      headers: { Authorization: `Bearer ${getToken()}` },\n    });\n\n    // Add a request interceptor to attach a\n    axiosInstance.interceptors.request.use(\n      (config) => ({\n        ...config,\n        headers: {\n          ...config.headers,\n          Authorization: `Bearer ${getToken()}`,\n        },\n      }),\n      (error) => Promise.reject(error)\n    );\n\n    // Add a response interceptor\n    axiosInstance.interceptors.response.use(\n      ({ data }) => data,\n      (error) => Promise.reject(error)\n    );\n\n    this.axiosInstance = axiosInstance;\n  }\n\n  async login({ username, password }) {\n    try {\n      const result = await this.axiosInstance.post(\"/auth/login\", {\n        username,\n        password,\n      });\n      return result;\n    } catch (err) {\n      helpMeInstructor(err);\n      throw err;\n    }\n  }\n\n  async logout() {\n    try {\n      await this.axiosInstance.get(\"/auth/logout\");\n    } catch (err) {\n      helpMeInstructor(err);\n      throw err;\n    }\n  }\n}\n\n\n// WARNING.. do not touch below this line if you want to have a good day =]\n\nfunction helpMeInstructor(err) {\n  console.info(\n    `\n    Did you hit CORRECT the endpoint?\n    Did you send the CORRECT data?\n    Did you make the CORRECT kind of request [GET/POST/PATCH/DELETE]?\n    Check the Kwitter docs üëâüèø https://kwitter-api.herokuapp.com/docs/#/\n    Check the Axios docs üëâüèø https://github.com/axios/axios\n    TODO: troll students\n  `,\n    err\n  );\n}\n\nfunction getToken() {\n  try {\n    const storedState = JSON.parse(localStorage.getItem(\"persist:root\"));\n    return JSON.parse(storedState.auth).isAuthenticated;\n  } catch {\n    return \"\";\n  }\n}\n\nexport default new API();\n"]},"metadata":{},"sourceType":"module"}